<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="report_asset" model="xlsx.template">
        <field name="res_model">xlsx.report.asset</field>
        <field name="fname">report_asset.xlsx</field>
        <field name="name">Asset Report</field>
        <field name="description">Asset Report</field>
        <field name="input_instruction">
            {
                '__EXPORT__': {
                    'Asset Report': {
                        '_HEAD_': {
                            'A3': '${env.user.company_id.name}',
                            'A4': 'date_filter${value or ""}',
                        },
                        'results': {
                            'A8': "${'=IF(?(T8)=?(T7),\"\",?(T8)'}#{font=bold}",
                            'B8': 'name${value or ""}',
                            'C8': 'date_start${value or ""}#{style=datestamp}',
                            'D8': 'purchase_value${value or 0}#{style=number}',
                            'E8': 'accumulated_bf${value or 0}#{style=number}',
                            'F8': 'method_number${value and "%.2f" % (100/float(value)) or 0}#{style=number}',
                            'G8': 'depreciation_base${value or 0}#{style=number}',
                            'H8': 'salvage_value${value or 0}#{style=number}',
                            'I8': 'depreciation${value or 0}#{style=number}',
                            'J8': 'accumulated_cf${value or 0}#{style=number}',
                            'K8': "${'=?(D8)-?(J8)'}#{style=number}",
                            'L8': 'code${value or ""}',
                            'M8': 'note${value or ""}',
                            # Hide Asset name
                            'T8': 'profile_id${value and value.name or ""}',
                        }
                    }
                },
            }
        </field>
    </record>

    <function model="xlsx.template" name="load_xlsx_template">
        <value eval="[ref('report_asset')]"/>
    </function>

</odoo>
